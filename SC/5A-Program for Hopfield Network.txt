import numpy as np
import matplotlib.pyplot as plt
import time

class HopfieldNetwork:
    def __init__(self, size):
        self.size = size
        self.weights = np.zeros((size, size))

    def train(self, patterns):
        for p in patterns:
            p = np.array(p)
            self.weights += np.outer(p, p)
        np.fill_diagonal(self.weights, 0)
        self.weights /= len(patterns)

    def recall(self, pattern, steps=5, delay=0.5):
        pattern = np.array(pattern)
        for step in range(steps):
            pattern = np.sign(np.dot(self.weights, pattern))
            self.plot_pattern(pattern, step)
            time.sleep(delay)
        return pattern

    def plot_pattern(self, pattern, step):
        plt.clf()
        plt.title(f"Hopfield Network - Step {step + 1}")
        plt.axis("off")
        pattern_2d=np.array(pattern.reshape(2,2))

        plt.imshow(pattern_2d, cmap="gray", vmin=-1, vmax=1)
        plt.draw()
        plt.pause(0.5)

patterns = [
    [1, -1, 1, -1],
    [-1, 1, -1, 1]
]

hopfield = HopfieldNetwork(size=4)
hopfield.train(patterns)

test_pattern = [1, -1, -1, -1]
print("Input pattern:", test_pattern)

plt.ion()
final_pattern = hopfield.recall(test_pattern, steps=6, delay=0.5)
plt.ioff()

print("Final recalled pattern:", final_pattern.tolist())

plt.show()
